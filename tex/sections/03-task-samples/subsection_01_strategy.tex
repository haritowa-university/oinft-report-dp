\subsection{Оптимальное распределение инвестиций}

Требуется распределить имеющиеся $B$ единиц средств среди $n$ предприятий, доход $g_i(x_i)$ от которых, в зависимости от количества вложенных средств $x_i$, определяется матрицей $(n \times n)$, приведенной в таблице \ref{table:opt:initial:data}, так, чтобы суммарный доход со всех предприятий был бы максимальным.

\begin{table}[!ht]
	\caption{Матрица расределения дохода в зависимости от вложенных средств}
	\label{table:opt:initial:data}
  \centering
  \begin{tabularx}{\linewidth}{ |X|X|X|X|X|X|X| }
	\hline
	$x$ \textbackslash $g_i$ & $g_1$ & $g_2$ & \textellipsis & $g_i$ & \textellipsis & $g_n$ \\
	\hline
	$x_1$ & $g_1(x_1)$ & $g_2(x_1)$ & \textellipsis & $g_i(x_1)$ & \textellipsis & $g_n(x_1)$ \\
	\hline
	$x_2$ & $g_1(x_2)$ & $g_2(x_2)$ & \textellipsis & $g_i(x_2)$ & \textellipsis & $g_n(x_2)$ \\
	\hline
	$x_2$ & \textellipsis & \textellipsis & \textellipsis & $g_i(x_2)$ & \textellipsis & $g_n(x_2)$ \\
	\hline
	$x_n$ & $g_1(x_n)$ & $g_2(x_n)$ & \textellipsis & $g_i(x_n)$ & \textellipsis & $g_n(x_n)$ \\
	\hline
  \end{tabularx}
\end{table}

Запишем математическую модель задачи: Определить $X^* = (x^*_1,x^*_2,\textellipsis,x^*_i,\textellipsis,x^*_n)$, удовлетворяющий условиям $\sum_{i=1}^n x_i = B; x_i \geq 0; i = 1, n$ и обеспечивающий максимум целевой функции $F(X) = \sum x_i g_i (x_i) \rightarrow \max$.

Очевидно, эта задача может быть решена простым перебором всех возможных вариантов распределения $В$ единиц средств по $n$ предприятиям, например на сетевой модели. Однако решим ее более эффективным методом, который заключается в замене сложной многовариантной задачи многократным решением простых задач с малым количеством исследуемых вариантов.

С этой целью разобьем процесс оптимизации на $n$ шагов и будем на каждом $k$-м шаге оптимизировать инвестирование не всех предприятий, а только предприятий с $k$-го по $n$-е. При этом естественно считать, что в остальные предприятия (с первого по ($k–1)$-е тоже вкладываются средства, и поэтому на инвестирование предприятий с $k$-го по $n$-е остаются не все средства, а некоторая меньшая сумма $С_k \leq В$. Эта величина и будет являться переменной состояния системы. Переменной управления на $k$-м шаге назовем величину $х_k$ средств, вкладываемых в $k$-e предприятие. В качестве функции Беллмана $F_k(C_k)$ на $k$-м шаге можно выбрать максимально возможный доход, который можно получить с предприятий с $k$-го по $n$-е при условии, что на их инвестирование осталось $С_k$ средств. Очевидно, что при вложении в $k$-e предприятие $х_k$ средств будет получена прибыль $g_k(x_k)$, а система к $(k+1)$-му шагу перейдет в состояние $S_{k+1}$ и, следовательно, на инвестирование предприятий с $(k+1)$-го до $n$-го останется $С_{k+1} = (С_k – х_k)$ средств.

Таким образом, на первом шаге условной оптимизации при $k = n$ функция Беллмана представляет собой прибыль только с $n$-го предприятия. При этом на его инвестирование может остаться количество средств $С_n, 0 \leq С_n \leq В$. Чтобы получить максимум прибыли с этого предприятия, можно вложить в него все эти средства, т. е. $F_n(С_n) = g_n(С_n)$ и $x_n = С_n$.

На каждом последующем шаге для вычисления функции Беллмана необходимо использовать результаты предыдущего шага. Пусть на $k$-м шаге для инвестирования предприятий с $k$-го по $n$-е осталось $C_k$ средств $(0 \leq С_k \leq В)$. Тогда от вложения в $k$-e предприятие $x_k$ средств будет получена прибыль $g_k(C_k)$, а на инвестирование остальных предприятий (с $k$-го по $n$-е) останется $С_{k+1} = (С_k – х_k)$ средств. Максимально возможный доход, который может быть получен с предприятий (с $k$-го по $n$-е), вычисляется по формуле \cite{formula:max:possible:income}:

\begin{equation}
\label{formula:max:possible:income}
F_k(C_k) = \max \{g_k(x_k) + F_{k+1}(c_k-x_k)\}; k = 1,\textellipsis,n
\end{equation}

Максимум выражения достигается на некотором значении $x^*_k$, которое является оптимальным управлением на $k$-м шаге для состояния системы $S_k$. Действуя таким образом, можно определить функции Беллмана и оптимальные управления до шага $k = 1$.

Значение функции Беллмана $F_1(c_1)$ представляет собой максимально возможный доход со всех предприятий, а значение $x^*_1$, на котором достигается максимум дохода, является оптимальным количеством средств, вложенных в первое предприятие. Далее на этапе безусловной оптимизации для всех последующих шагов вычисляется величина $С_k = (С_{k-1} – x_{k-1})$ оптимальным управлением на $k$-м шаге является то значение $x_k$, которое обеспечивает максимум дохода при соответствующем состоянии системы $S_k$.